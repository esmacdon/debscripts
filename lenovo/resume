  GNU nano 4.8                                             /usr/lib/systemd/system-sleep/resume                                                       
#!/bin/sh

case $1/$2 in
  pre/*)
    echo "Going to $2..."
    # Place your pre suspend commands here, or `exit 0`
    # if no pre suspend action required
        /home/evan/gpustart
        echo "sleep" > /home/evan/sleep
        exit 0
    ;;
  post/*)
    echo "Waking up from $2..."
    # Place your post suspend (resume) commands here, or `exit 0` 
    # if no post suspend action required
        sudo x86_energy_perf_policy --turbo-enable 1

        #sleep 2
        for h in {1..3}
        do
                for i in {1..30}
                do
                        for j in {1..10}
                        do
                        sudo pkill nvidia*
                        /home/evan/gpuexit
                        if cat /proc/acpi/bbswitch | grep OFF; then
                                echo DID
                                break
                        fi
                        done

                if cat /proc/acpi/bbswitch | grep OFF; then
			echo DID
                        break
                fi
                sleep 1
                done
        sleep 3
        done
        echo "wake" > /home/evan/wake
    ;;
esac
